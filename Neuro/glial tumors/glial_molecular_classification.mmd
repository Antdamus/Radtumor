flowchart TD
  A[Adult-type diffuse gliomas - infiltrating] --> B{IDH1 / IDH2 mutation?}

  %% IDH-mutant branch
  B -->|Yes IDH-mutant| C{1p/19q codeletion?}
  C -->|Yes| O[Oligodendroglioma\nIDH-mutant and 1p/19q-codeleted\nWHO grade 2 or 3]
  C -->|No| AS[Astrocytoma\nIDH-mutant\nWHO grade 2, 3, or 4]

  %% Oligodendroglioma details
  O --> O1[Common molecular\nTERT promoter mutation]
  O --> O2[ATRX retained\nTP53 usually wildtype]
  O --> O3[Grade 3 features\nIncreased mitoses\nMicrovascular proliferation or necrosis may be present]

  %% Astrocytoma IDH-mutant details
  AS --> AS1[Common molecular\nATRX loss\nTP53 mutation]
  AS --> AS2[WHO grade 4 if ANY\nNecrosis\nMicrovascular proliferation\nCDKN2A/B homozygous deletion]
  AS --> AS3[Grade 2 to 3 based on histology\nCellularity\nAnaplasia\nMitotic activity]

  %% IDH-wildtype branch
  B -->|No IDH-wildtype| D{GBM-defining molecular features?}
  D -->|Yes| GBM[Glioblastoma\nIDH-wildtype\nWHO grade 4]
  D -->|No| E[Diffuse astrocytoma\nIDH-wildtype\nNOS or NEC]

  %% GBM defining molecular features
  GBM --> G1[Upgrade to GBM if ANY\nEGFR amplification\nTERT promoter mutation\nChromosome plus 7 minus 10]
  GBM --> G2[Typical histology\nNecrosis\nMicrovascular proliferation]
  GBM --> G3[Other common findings\nPTEN loss\nCDKN2A/B deletion\nMGMT promoter methylation]

  %% If IDH-wt without GBM features
  E --> E1[Consider other entities\nH3 K27-altered midline glioma\nH3 G34-mutant hemispheric glioma]
  E --> E2[Consider MAPK-altered gliomas\nPleomorphic xanthoastrocytoma]
  E --> E3[If incomplete workup\nLabel as NOS or NEC]

  %% High-contrast classes
  classDef decision fill:#ede7f6,stroke:#4527a0,color:#000000,stroke-width:2px
  classDef idhmut fill:#bbdefb,stroke:#0d47a1,color:#000000,stroke-width:2px
  classDef oligo fill:#c8e6c9,stroke:#1b5e20,color:#000000,stroke-width:2px
  classDef astro fill:#ffe0b2,stroke:#e65100,color:#000000,stroke-width:2px
  classDef gbm fill:#c62828,stroke:#000000,color:#ffffff,stroke-width:2px
  classDef aux fill:#eeeeee,stroke:#424242,color:#000000,stroke-width:1px

  %% Apply classes
  class B,C,D decision
  class O,O1,O2,O3 oligo
  class AS,AS1,AS2,AS3 astro
  class GBM,G1,G2,G3 gbm
  class E,E1,E2,E3 aux
